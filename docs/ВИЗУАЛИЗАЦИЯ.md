# üìä –í–ò–ó–£–ê–õ–ò–ó–ê–¶–ò–Ø –£–õ–£–ß–®–ï–ù–ù–û–ì–û –ò–ù–°–¢–ê–õ–Ø–¢–û–†–ê

> **–î–∏–∞–≥—Ä–∞–º–º—ã –∏ —Å—Ö–µ–º—ã –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã v5.0**

---

## üèóÔ∏è –ê–†–•–ò–¢–ï–ö–¢–£–†–ê –ú–û–î–£–õ–ï–ô

```mermaid
graph TB
    Main[install.sh<br/>–ì–ª–∞–≤–Ω—ã–π —Å–∫—Ä–∏–ø—Ç] --> Lib{–ë–∏–±–ª–∏–æ—Ç–µ–∫–∏}
    
    Lib --> Common[common.sh<br/>–£—Ç–∏–ª–∏—Ç—ã<br/>196 —Å—Ç—Ä–æ–∫]
    Lib --> Logging[logging.sh<br/>–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ<br/>191 —Å—Ç—Ä–æ–∫–∞]
    Lib --> Checks[checks.sh<br/>Pre-flight<br/>306 —Å—Ç—Ä–æ–∫]
    Lib --> Progress[progress.sh<br/>Progress Bar<br/>228 —Å—Ç—Ä–æ–∫]
    Lib --> Rollback[rollback.sh<br/>–û—Ç–∫–∞—Ç<br/>262 —Å—Ç—Ä–æ–∫–∏]
    Lib --> Database[database.sh<br/>PostgreSQL<br/>210 —Å—Ç—Ä–æ–∫]
    Lib --> Cache[cache.sh<br/>Redis<br/>144 —Å—Ç—Ä–æ–∫–∏]
    Lib --> Queue[queue.sh<br/>RabbitMQ<br/>313 —Å—Ç—Ä–æ–∫]
    Lib --> Backend[backend.sh<br/>PHP+Python<br/>279 —Å—Ç—Ä–æ–∫]
    Lib --> Webserver[webserver.sh<br/>Apache/NGINX<br/>365 —Å—Ç—Ä–æ–∫]
    Lib --> Finalize[finalize.sh<br/>–§–∏–Ω–∞–ª–∏–∑–∞—Ü–∏—è<br/>298 —Å—Ç—Ä–æ–∫]
    Lib --> Tests[tests.sh<br/>Smoke Tests<br/>276 —Å—Ç—Ä–æ–∫]
    
    style Main fill:#2196f3,color:#fff
    style Common fill:#4caf50,color:#fff
    style Logging fill:#ff9800,color:#fff
    style Checks fill:#9c27b0,color:#fff
    style Progress fill:#00bcd4,color:#fff
    style Rollback fill:#f44336,color:#fff
    style Database fill:#336791,color:#fff
    style Cache fill:#dc382d,color:#fff
    style Queue fill:#ff6600,color:#fff
    style Backend fill:#8892be,color:#fff
    style Webserver fill:#009688,color:#fff
    style Finalize fill:#673ab7,color:#fff
    style Tests fill:#795548,color:#fff
```

---

## üîÑ –ü–û–¢–û–ö –£–°–¢–ê–ù–û–í–ö–ò

```mermaid
sequenceDiagram
    participant User as üë§ –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä
    participant Install as üìú install.sh
    participant Checks as üîç checks.sh
    participant DB as üóÑÔ∏è database.sh
    participant Cache as üíæ cache.sh
    participant Queue as üì® queue.sh
    participant Backend as ‚öôÔ∏è backend.sh
    participant Web as üåê webserver.sh
    participant Final as üéØ finalize.sh
    participant Tests as üß™ tests.sh
    
    User->>Install: sudo ./install.sh
    
    Install->>Checks: run_preflight_checks()
    Checks-->>Install: ‚úÖ All checks passed
    
    Install->>Install: –í—ã–±–æ—Ä –¥–æ–º–µ–Ω–∞
    User-->>Install: example.com
    
    Install->>Final: setup_firewall()
    Final-->>Install: ‚úÖ Firewall configured
    
    Install->>DB: setup_database()
    DB->>DB: install_postgresql()
    DB->>DB: configure_postgresql()
    DB->>DB: verify_postgresql()
    DB-->>Install: ‚úÖ PostgreSQL ready
    
    Install->>Cache: setup_cache()
    Cache->>Cache: install_redis()
    Cache->>Cache: configure_redis()
    Cache->>Cache: verify_redis()
    Cache-->>Install: ‚úÖ Redis ready
    
    Install->>Queue: setup_queue()
    Queue->>Queue: install_rabbitmq()
    Queue->>Queue: configure_rabbitmq()
    Queue->>Queue: create_rabbitmq_users()
    Queue->>Queue: verify_rabbitmq()
    Queue-->>Install: ‚úÖ RabbitMQ ready
    
    Install->>Backend: setup_backend()
    Backend->>Backend: install_php()
    Backend->>Backend: configure_php()
    Backend->>Backend: install_python()
    Backend->>Backend: configure_python()
    Backend->>Backend: install_supervisor()
    Backend-->>Install: ‚úÖ Backend ready
    
    Install->>Web: setup_webserver()
    Web->>Web: select_webserver()
    User-->>Web: Apache
    Web->>Web: install_apache()
    Web->>Web: configure_apache()
    Web->>Web: verify_webserver()
    Web-->>Install: ‚úÖ Web server ready
    
    Install->>Final: finalize_installation()
    Final->>Final: create_env_file()
    Final->>Final: set_permissions()
    Final->>Final: download_installer_phar()
    Final->>Final: show_credentials()
    User-->>Final: –°–∫–æ–ø–∏—Ä–æ–≤–∞–ª –ø–∞—Ä–æ–ª–∏, Enter
    Final->>Final: run_phar_installer()
    Final-->>Install: ‚úÖ Finalized
    
    Install->>Tests: run_smoke_tests()
    Tests->>Tests: 11 —Ç–µ—Å—Ç–æ–≤
    Tests-->>Install: ‚úÖ All tests passed
    
    Install-->>User: ‚úÖ Installation completed!
```

---

## üìà –ü–†–û–ì–†–ï–°–° –£–°–¢–ê–ù–û–í–ö–ò

```mermaid
gantt
    title –£–ª—É—á—à–µ–Ω–Ω—ã–π –∏–Ω—Å—Ç–∞–ª—è—Ç–æ—Ä - Process Timeline
    dateFormat mm:ss
    axisFormat %M:%S
    
    section –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞
    Pre-flight checks      :done, pre1, 00:00, 2m
    System info            :done, pre2, 02:00, 1m
    Domain selection       :done, pre3, 03:00, 1m
    
    section –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞
    Firewall setup         :active, inf1, 04:00, 2m
    
    section –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
    PostgreSQL install     :db1, 06:00, 6m
    PostgreSQL config      :db2, 12:00, 2m
    
    section –ö—ç—à –∏ –æ—á–µ—Ä–µ–¥–∏
    Redis install          :cache1, 14:00, 3m
    RabbitMQ install       :queue1, 17:00, 8m
    RabbitMQ config        :queue2, 25:00, 2m
    
    section Backend
    PHP install            :back1, 27:00, 8m
    Python install         :back2, 35:00, 3m
    Supervisor install     :back3, 38:00, 2m
    
    section –í–µ–±-—Å–µ—Ä–≤–µ—Ä
    Apache/NGINX install   :web1, 40:00, 4m
    Web server config      :web2, 44:00, 2m
    
    section –§–∏–Ω–∞–ª–∏–∑–∞—Ü–∏—è
    Create .env            :final1, 46:00, 1m
    Download phar          :final2, 47:00, 2m
    Run phar installer     :final3, 49:00, 3m
    
    section –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
    Smoke tests            :test1, 52:00, 3m
```

---

## üéØ –ü–û–ö–†–´–¢–ò–ï –§–£–ù–ö–¶–ò–û–ù–ê–õ–¨–ù–û–°–¢–ò

```mermaid
pie title –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —É–ª—É—á—à–µ–Ω–∏–π
    "Pre-flight Checks" : 11
    "Logging System" : 5
    "Progress Indicator" : 4
    "Rollback System" : 6
    "Installation Modules" : 7
    "Smoke Tests" : 11
    "Config Options" : 20
```

---

## üîÄ –û–ë–†–ê–ë–û–¢–ö–ê –û–®–ò–ë–û–ö

```mermaid
stateDiagram-v2
    [*] --> Preflight: Start
    Preflight --> ChecksPassed: ‚úÖ All OK
    Preflight --> ChecksFailed: ‚ùå Errors
    ChecksFailed --> [*]: Exit with error
    
    ChecksPassed --> Installing: Begin installation
    
    Installing --> Database: Step 1
    Database --> DatabaseOK: ‚úÖ Success
    Database --> DatabaseFail: ‚ùå Error
    
    DatabaseOK --> Cache: Step 2
    Cache --> CacheOK: ‚úÖ Success
    Cache --> CacheFail: ‚ùå Error
    
    CacheOK --> Queue: Step 3
    Queue --> QueueOK: ‚úÖ Success
    Queue --> QueueFail: ‚ùå Error
    
    QueueOK --> Backend: Step 4
    Backend --> BackendOK: ‚úÖ Success
    Backend --> BackendFail: ‚ùå Error
    
    BackendOK --> Webserver: Step 5
    Webserver --> WebOK: ‚úÖ Success
    Webserver --> WebFail: ‚ùå Error
    
    WebOK --> Finalize: Step 6
    Finalize --> FinalOK: ‚úÖ Success
    Finalize --> FinalFail: ‚ùå Error
    
    FinalOK --> Tests: Step 7
    Tests --> Success: ‚úÖ All passed
    Tests --> PartialSuccess: ‚ö†Ô∏è Some failed
    
    Success --> [*]: Complete
    PartialSuccess --> [*]: Complete with warnings
    
    DatabaseFail --> Rollback
    CacheFail --> Rollback
    QueueFail --> Rollback
    BackendFail --> Rollback
    WebFail --> Rollback
    FinalFail --> Rollback
    
    Rollback --> StopServices
    StopServices --> RemoveDB
    RemoveDB --> RemoveUsers
    RemoveUsers --> RemoveFiles
    RemoveFiles --> CleanDirs
    CleanDirs --> [*]: System restored
```

---

## üì¶ –ó–ê–í–ò–°–ò–ú–û–°–¢–ò –ú–û–î–£–õ–ï–ô

```mermaid
graph LR
    Common[common.sh] --> All{–í—Å–µ –º–æ–¥—É–ª–∏}
    Logging[logging.sh] --> All
    
    All --> Checks[checks.sh]
    All --> Progress[progress.sh]
    All --> Rollback[rollback.sh]
    All --> Database[database.sh]
    All --> Cache[cache.sh]
    All --> Queue[queue.sh]
    All --> Backend[backend.sh]
    All --> Webserver[webserver.sh]
    All --> Finalize[finalize.sh]
    All --> Tests[tests.sh]
    
    Database --> Finalize
    Cache --> Finalize
    Queue --> Finalize
    Backend --> Webserver
    Webserver --> Finalize
    Finalize --> Tests
    
    style Common fill:#4caf50,color:#fff
    style Logging fill:#ff9800,color:#fff
```

---

## üß© –ö–û–ú–ü–û–ù–ï–ù–¢–´ –°–ò–°–¢–ï–ú–´

```mermaid
mindmap
  root((WorkerNet<br/>Installer<br/>v5.0))
    –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –º–æ–¥—É–ª–∏
      Pre-flight Checks
        11 –ø—Ä–æ–≤–µ—Ä–æ–∫
      Logging
        5 —É—Ä–æ–≤–Ω–µ–π
      Progress Bar
        ETA —Ä–∞—Å—á–µ—Ç
      Rollback
        –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π
    –ú–æ–¥—É–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∏
      Database
        PostgreSQL 16
        PostGIS 3
      Cache
        Redis 7
      Queue
        RabbitMQ 3.x
        Erlang
      Backend
        PHP 8.3
        Python 3
        Supervisor
      Webserver
        Apache
        NGINX
    –§–∏–Ω–∞–ª–∏–∑–∞—Ü–∏—è
      Firewall
      .env —Ñ–∞–π–ª
      Phar installer
      Smoke tests
    –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
      YAML —Ñ–∞–π–ª
      50+ –æ–ø—Ü–∏–π
      Defaults
```

---

## üìä SMOKE TESTS

```mermaid
graph TB
    Start[üß™ Smoke Tests] --> T1[Test 1: Services]
    T1 --> T2[Test 2: Ports]
    T2 --> T3[Test 3: Database]
    T3 --> T4[Test 4: PostGIS]
    T4 --> T5[Test 5: Redis]
    T5 --> T6[Test 6: RabbitMQ Users]
    T6 --> T7[Test 7: Web Server]
    T7 --> T8[Test 8: PHP]
    T8 --> T9[Test 9: .env File]
    T9 --> T10[Test 10: Permissions]
    T10 --> T11[Test 11: Supervisor]
    
    T11 --> Summary{–†–µ–∑—É–ª—å—Ç–∞—Ç—ã}
    Summary -->|All passed| Success[‚úÖ System Ready]
    Summary -->|Some failed| Partial[‚ö†Ô∏è Review Required]
    
    style Start fill:#2196f3,color:#fff
    style Success fill:#4caf50,color:#fff
    style Partial fill:#ff9800,color:#fff
```

---

## üéØ –†–ï–ó–£–õ–¨–¢–ê–¢

**–°–æ–∑–¥–∞–Ω —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π, –Ω–∞–¥–µ–∂–Ω—ã–π, –≤–∏–∑—É–∞–ª—å–Ω–æ –ø–æ–Ω—è—Ç–Ω—ã–π –∏–Ω—Å—Ç–∞–ª—è—Ç–æ—Ä!**

- ‚úÖ 12 –º–æ–¥—É–ª–µ–π
- ‚úÖ 3068 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞
- ‚úÖ 100% —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
- ‚úÖ Production-ready

**–ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é! üöÄ**

---

**–°–æ–∑–¥–∞–Ω–æ:** 23 –æ–∫—Ç—è–±—Ä—è 2025  
**–í–µ—Ä—Å–∏—è:** 1.0

