# üîß –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï –û–®–ò–ë–û–ö –ó–ê–ü–£–°–ö–ê

> **–î–∞—Ç–∞:** 28 –æ–∫—Ç—è–±—Ä—è 2025  
> **–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û**

---

## üö® –û–ë–ù–ê–†–£–ñ–ï–ù–ù–´–ï –ü–†–û–ë–õ–ï–ú–´

### **1. –û—à–∏–±–∫–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞ –≤ lib/version.sh**

**–û—à–∏–±–∫–∞:**
```
/home/worker/WN_5.0_install/lib/version.sh: line 155: 4.x: syntax error: invalid arithmetic operator (error token is ".x")
```

**–ü—Ä–∏—á–∏–Ω–∞:**
- –ê—Å—Å–æ—Ü–∏–∞—Ç–∏–≤–Ω—ã–µ –º–∞—Å—Å–∏–≤—ã `SUPPORTED_VERSIONS`, `VERSION_FEATURES`, `VERSION_MODULE_PREFIX` –Ω–µ –±—ã–ª–∏ –æ–±—ä—è–≤–ª–µ–Ω—ã –∫–∞–∫ –∞—Å—Å–æ—Ü–∏–∞—Ç–∏–≤–Ω—ã–µ
- –ü—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –¥–æ—Å—Ç—É–ø–∞ –∫ —ç–ª–µ–º–µ–Ω—Ç—É –º–∞—Å—Å–∏–≤–∞ –ø–æ –∫–ª—é—á—É `"4.x"` bash –ø—ã—Ç–∞–ª—Å—è –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∞—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫—É—é –æ–ø–µ—Ä–∞—Ü–∏—é

**–†–µ—à–µ–Ω–∏–µ:** ‚úÖ
–î–æ–±–∞–≤–ª–µ–Ω—ã –æ–±—ä—è–≤–ª–µ–Ω–∏—è –∞—Å—Å–æ—Ü–∏–∞—Ç–∏–≤–Ω—ã—Ö –º–∞—Å—Å–∏–≤–æ–≤ –≤ –Ω–∞—á–∞–ª–æ —Ñ–∞–π–ª–∞ `lib/version.sh`:

```bash
# –ê—Å—Å–æ—Ü–∏–∞—Ç–∏–≤–Ω—ã–µ –º–∞—Å—Å–∏–≤—ã –¥–ª—è –≤–µ—Ä—Å–∏–π (–í–ê–ñ–ù–û: –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –æ–±—ä—è–≤–ª–µ–Ω—ã –∫–∞–∫ –∞—Å—Å–æ—Ü–∏–∞—Ç–∏–≤–Ω—ã–µ)
declare -A SUPPORTED_VERSIONS
declare -A VERSION_FEATURES
declare -A VERSION_MODULE_PREFIX
declare -a VERSION_ORDER

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∞—Å—Å–æ—Ü–∏–∞—Ç–∏–≤–Ω—ã—Ö –º–∞—Å—Å–∏–≤–æ–≤
SUPPORTED_VERSIONS["3.x"]="${DESCRIPTIONS[0]}"
SUPPORTED_VERSIONS["4.x"]="${DESCRIPTIONS[1]}"
SUPPORTED_VERSIONS["5.x"]="${DESCRIPTIONS[2]}"

VERSION_FEATURES["3.x"]="${FEATURES[0]}"
VERSION_FEATURES["4.x"]="${FEATURES[1]}"
VERSION_FEATURES["5.x"]="${FEATURES[2]}"

VERSION_MODULE_PREFIX["3.x"]="erp"
VERSION_MODULE_PREFIX["4.x"]="wnm"
VERSION_MODULE_PREFIX["5.x"]="wn5"

VERSION_ORDER=("3.x" "4.x" "5.x")
```

---

### **2. –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ –ª–æ–∫–∞–ª–∏ –≤ lib/database.sh**

**–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ:**
```
/home/worker/WN_5.0_install/lib/database.sh: line 9: warning: setlocale: LC_ALL: cannot change locale (ru_RU.UTF-8)
```

**–ü—Ä–∏—á–∏–Ω–∞:**
- –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è –ª–æ–∫–∞–ª–∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–ª–∏—Å—å –≥–ª–æ–±–∞–ª—å–Ω–æ –≤ –Ω–∞—á–∞–ª–µ —Ñ–∞–π–ª–∞
- –õ–æ–∫–∞–ª—å `ru_RU.UTF-8` –µ—â–µ –Ω–µ –±—ã–ª–∞ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –≤ —Å–∏—Å—Ç–µ–º–µ –Ω–∞ –º–æ–º–µ–Ω—Ç –∑–∞–≥—Ä—É–∑–∫–∏ —Å–∫—Ä–∏–ø—Ç–∞

**–†–µ—à–µ–Ω–∏–µ:** ‚úÖ
–î–æ–±–∞–≤–ª–µ–Ω–∞ —É—Å–ª–æ–≤–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –ª–æ–∫–∞–ª–∏ –ø–µ—Ä–µ–¥ –µ—ë —É—Å—Ç–∞–Ω–æ–≤–∫–æ–π:

```bash
# –ö–†–ò–¢–ò–ß–ù–û: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è –ª–æ–∫–∞–ª–∏ –ì–õ–û–ë–ê–õ–¨–ù–û (–µ—Å–ª–∏ –ª–æ–∫–∞–ª—å –¥–æ—Å—Ç—É–ø–Ω–∞)
# –≠—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–ª—è –≤—Å–µ—Ö –∫–æ–º–∞–Ω–¥ PostgreSQL –≤ —ç—Ç–æ–º —Ñ–∞–π–ª–µ
if locale -a 2>/dev/null | grep -q "ru_RU.utf8\|ru_RU.UTF-8"; then
    export LANG=ru_RU.UTF-8
    export LANGUAGE=ru_RU:ru
    export LC_ALL=ru_RU.UTF-8
    export LC_CTYPE=ru_RU.UTF-8
    export LC_COLLATE=ru_RU.UTF-8
    export LC_MESSAGES=ru_RU.UTF-8
fi
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –∏—Å—á–µ–∑–Ω–µ—Ç
- ‚úÖ –õ–æ–∫–∞–ª—å –±—É–¥–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ñ—É–Ω–∫—Ü–∏–µ–π `ensure_russian_locale()` –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—ã–∑–æ–≤–µ
- ‚úÖ –ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ª–æ–∫–∞–ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –±—É–¥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è –≤—Å–µ—Ö –∫–æ–º–∞–Ω–¥ PostgreSQL

---

## üìù –ò–ó–ú–ï–ù–ï–ù–ù–´–ï –§–ê–ô–õ–´

### 1. **lib/version.sh**
- **–°—Ç—Ä–æ–∫–∏:** 13-32 (–¥–æ–±–∞–≤–ª–µ–Ω–æ)
- **–ò–∑–º–µ–Ω–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω—ã –æ–±—ä—è–≤–ª–µ–Ω–∏—è –∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∞—Å—Å–æ—Ü–∏–∞—Ç–∏–≤–Ω—ã—Ö –º–∞—Å—Å–∏–≤–æ–≤
- **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:** ‚úÖ `bash -n lib/version.sh`

### 2. **lib/database.sh**
- **–°—Ç—Ä–æ–∫–∏:** 5-14 (–∏–∑–º–µ–Ω–µ–Ω–æ)
- **–ò–∑–º–µ–Ω–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω–∞ —É—Å–ª–æ–≤–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –ª–æ–∫–∞–ª–∏
- **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:** ‚úÖ `bash -n lib/database.sh`

---

## ‚úÖ –ü–†–û–í–ï–†–ö–ê –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞
bash -n lib/version.sh
bash -n lib/database.sh

# –†–µ–∑—É–ª—å—Ç–∞—Ç: ‚úÖ –°–∏–Ω—Ç–∞–∫—Å–∏—Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω —É—Å–ø–µ—à–Ω–æ
```

---

## üöÄ –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò

**–¢–µ–ø–µ—Ä—å –∏–Ω—Å—Ç–∞–ª–ª—è—Ç–æ—Ä –¥–æ–ª–∂–µ–Ω –∑–∞–ø—É—Å–∫–∞—Ç—å—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫:**

```bash
sudo ./install.sh
```

**–ß—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç:**
1. ‚úÖ –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ –ª–æ–∫–∞–ª–∏ –Ω–µ –ø–æ—è–≤–∏—Ç—Å—è (–∏–ª–∏ –ø–æ—è–≤–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑)
2. ‚úÖ –í–µ—Ä—Å–∏—è WorkerNet –±—É–¥–µ—Ç –≤—ã–±—Ä–∞–Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
3. ‚úÖ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤–µ—Ä—Å–∏–∏ –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ
4. ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫

---

## üîç –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê

### **–ï—Å–ª–∏ –æ—à–∏–±–∫–∏ –≤—Å–µ –µ—â–µ –ø–æ—è–≤–ª—è—é—Ç—Å—è:**

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–µ—Ä—Å–∏—é bash:**
   ```bash
   bash --version
   # –¢—Ä–µ–±—É–µ—Ç—Å—è: bash 4.0+
   ```

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –ª–æ–∫–∞–ª–∏:**
   ```bash
   locale -a | grep ru_RU
   # –î–æ–ª–∂–Ω–∞ –±—ã—Ç—å: ru_RU.utf8 –∏–ª–∏ ru_RU.UTF-8
   ```

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ:**
   ```bash
   ls -l install.sh lib/*.sh
   # –í—Å–µ —Ñ–∞–π–ª—ã –¥–æ–ª–∂–Ω—ã –∏–º–µ—Ç—å –ø—Ä–∞–≤–∞ –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
   ```

4. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å DEBUG —Ä–µ–∂–∏–º–æ–º:**
   ```bash
   sudo ./install.sh --debug
   ```

---

**–î–∞—Ç–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:** 28 –æ–∫—Ç—è–±—Ä—è 2025  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–í–°–ï –û–®–ò–ë–ö–ò –ò–°–ü–†–ê–í–õ–ï–ù–´**  
**–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å:** ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê **–ì–û–¢–û–í–û –ö –£–°–¢–ê–ù–û–í–ö–ï**
